<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Team 2</title>
    <link rel="stylesheet" href="/css/ss.css"/>
    <link rel="shortcut icon" href="https://avatars.githubusercontent.com/u/156639586?s=400&u=621764cc2e33c11be01f5540c01c11fda2c33e43&v=4">
    <script src="/script/script.js"></script>
</head>

<body>
<div id="popupContainer" class="popup-container"></div>

<!-- 레이어 팝업 ADD-->
<div th:replace="~{modal/addModal :: addModal}" />

<!--레이어팝업 수정-->
<div th:replace="~{modal/editModal :: editMoodal}" />

<!--레이어팝업 삭제-->
<div th:replace="~{modal/deleteModal :: deleteModal}" />

<!--레이어 팝업 ADTest-->
<div th:replace="~{modal/userInfoModal :: userInfoModal}" th:hidden="${totalNum == 0}"/>
<!-- 제목 -->
<h2 class=mainTitle>AD Manager Platform - AD List</h2>
<div class=levelBox>
    <div class="buttonLevel">
        <button id=ADDButton type="button" onclick="openPopup('popupAdd')">ADD</button>
        <span></span>
        <button id=ADTestButton type="button" onclick="openPopup('popupAdTest')">AD Test</button>

    </div>

    <!-- 검색 테이블 -->
    <form th:object="${searchForm}" class="searchLevel">
        <select th:field="*{isActive}" id = "searchSelect">
            <option value="">광고상태</option>
            <option th:value="true" th:text="활성"></option>
            <option th:value="false" th:text="만료"></option>
        </select>
        <input type="text" th:field="*{searchText}" id="searchInput"  placeholder="ad title"/>
        <button type="submit">검색</button>
    </form>

    <!-- 테이블 -->
    <div class="tableLevel">
        <table id="ADTable">
            <thead>
            <tr>
                <td>idx</td>
                <td>advertiser</td>
                <td>text</td>
                <td>Exposure datetime</td>
                <td>count</td>
                <td>regdate</td>
                <td>광고 만료 여부</td>
                <td>action</td>
            </tr>
            </thead>
            <tbody>
            <tr id="tableRow" th:each="ad : ${ads}">
                <td id="idx" th:text="${ad.id}" />
                <td id="advertiser" th:text="${ad.getContracts().getAdvertiser().getName()}" />
                <td id="text" th:text="${ad.text}" />
                <td id="EDT"><span th:text="${ad.getContracts().getStartDate()}"/> ~ <span
                        th:text="${ad.getContracts().getEndDate()}"/></td>
                <td id="count" th:text="${ad.price}" />
                <td id="regdate" th:text="${ad.getContracts().getStartDate()}" />
                <td id="isActive" th:text="${ad.getContracts().getIsActive() ? '활성' : '만료'}" />
                <td id="action">
                    <form name="detailForm" action="/">
                        <button name ="detailButton" class="button">
                            <a id="detailLink" th:href="@{/detail/{id}(id=${ad.id})}" class="">상세</a>
                        </button>
                    </form>
                    <button type="button" th:onclick="'openIdPopup(\'popupModify\', \'' + ${ad.id} + '\')'">수정</button>
                    <button type="button" th:onclick="'openIdPopup(\'popupDelete\', \'' + ${ad.id} + '\')'">삭제</button>
                </td>
            </tr>
            </tbody>
        </table>
        <!-- 페이지네이션 버튼 -->
    </div>
    <div class="paginationLevel">
        <span></span>
        <div>
            <form name="exexForm" action="/">
                <button id="exexButton" type="submit"></button>
            </form>
            <form name="exForm" action="/">
                <button id="exButton" type="submit"></button>
            </form>
            <form name="curForm"  action="/">
                <button id="curButton" type="submit"></button>
            </form>
            <form   name="postForm" action="/">
                <button id="postButton" type="submit"></button>
            </form>
            <form  name="postpostForm" action="/">
                <button id="postpostButton" type="submit"></button>
            </form>

            <script th:inline="javascript">
                let totalNum = [[${totalNum}]];
                let endPage = Math.floor(totalNum / 5)+1;
                let curPage = [[${pageNum}]];
                //document.getElementById("toEndPage").action = '/' + endPage;
                if(totalNum===0){

                }else{
                    pageButton(endPage,curPage);
                }
            </script>
        </div>
        <span></span>
    </div>
</div>
</body>
</html>
